{{ self.title() }}

{{ s('background') }}

{{ img('background.jpg', size = 0.17, align = 'middle', inline = False, caption='最后一次是隔空碰拳') }}

{{ s('description') }}

**本题包含多组测试数据**。

Simons 作为学生会的副会长，还想竞选学生会的文艺部长，为此他找到自己的好朋友同时也是会长的 Jeremy 让他给自己留一个后门。Jeremy 当然很爽快地答应了。

学生会的管理层有 $n$ 个成员，编号从 $1$ 至 $n$。编号为 $i$ 的成员等级为 $n-i+1$。每个成员都管理等级低于自己的成员。

在竞选文艺部长时，每个成员都有 $a_i$ 张票（保证至少有 $1$ 张票）和一个 $w_i$ 的权重。获得超过总票数严格一半的成员可以当选文艺部长。

竞选会持续 $n$ 天。为了保证竞选的秩序，Jeremy 要求成员 $i$ 必须在第 $i$ 天作出以下选择中的一个，第 $0$ 天时所有成员都不处于**已投票状态**。

- **对 $v$ 投票**：指定一个成员 $v$，将自己的 $a_i$ 张票花费 $w_i$ 的代价投给 $v$，自己变为**已投票状态**。
- **对 $v$ 揽票**：首先花费 $w_i$ 的代价指定一个成员 $v$，需要满足 $v$ 的等级小于等于 $i$。然后，对于等级小于等于 $v$ 的所有成员 $j$，若 $j$ 此刻未处于**已投票状态**，则 $j$ 的 $a_j$ 张票都花费 $w_j$ 的代价投给 $i$，$j$ 变为**已投票状态**。
- **弃票**。

每个成员在选择时都知道前面已经选择过的人的选择，且他们都**绝顶聪明**地希望其他成员不会当选文艺部长。

Jeremy 对着竞选规则苦思冥想，最后给 Simons 设计了一个开后门的方法：

Simons 可以指定一位成员 $x$ 从第 $x$ 天提前到第 $1$ 天作选择。此后他不再作选择，成员 $1$ 至 $x-1$ 作出选择的时间依次顺延到第 $2$ 天至第 $x$ 天，其他成员作出选择的时间不变。

假设指定的成员 $x$ 要**确保**自己当选文艺部长需要花费的最小代价为 $f(x)$（如果不能确保则 $f(x)=+\infty$）。由于 Simons 不知道该选择哪位成员，所以你需要告诉他 $\min\limits_{x=1}^n\{f(x)\}$。

可以证明，一定存在可以确保自己当选文艺部长的成员，即 $\exist x\in[1,n],f(x)\ne +\infty$。

由于局势瞬息万变，所以 $a$ 和 $w$ 会发生 $q$ 次变化。其中票数 $a$ 始终是正数，权重 $w$ 受信誉影响**不会变大**。

Simons 很有大局观，所以他需要知道所有变化开始前和每一次变化后的答案。

**本题强制在线。**

{{ s('input format') }}

{{ self.input_file() }}

第一行一个整数 $T$，表示数据组数。

对于每组数据：

一行三个整数 $n,q,type$，表示成员数量、变化次数、是否强制在线。

接下来 $n$ 行，每行两个整数 $a_i,w_i$，从 $1$ 到 $n$ 依次表示成员 $i$ 的票数和权重。

接下来 $q$ 行，每行三个整数 $o,p',x'$。设 $lst$ 表示上一次输出的答案的绝对值，则 $p\gets p'\oplus(type\times lst),x\gets (|x'|\oplus(type\times lst))\times (-1)^{[x'\leq 0]}$（其中 $[x'\leq 0]$ 为[艾佛森括号](https://baike.baidu.com/item/%E8%89%BE%E4%BD%9B%E6%A3%AE%E6%8B%AC%E5%8F%B7/22361197)），然后：

1. $o=1$ 时，将 $a_p$ 改为 $x$。保证 $a$ 中所有元素始终为正整数。
2. $o=2$ 时，将 $w_p$ 改为 $w_p'=x$。保证 $w_p\geq w_p'$。

{{ s('output format') }}

{{ self.output_file() }}

输出 $q+1$ 行，其中第一行为所有变化前的答案，之后 $q$ 行表示每次变化后的答案。

{{ s('sample', 1) }}

{{ self.sample_text() }}

上面是自动读入样例 `1.in/ans`（存储在 `down` 文件夹内） 然后渲染到题面中；如果只有一组样例，则去掉 `1` 或将其替换成空串，样例仍然保存成 `1.in/ans`。上面的 `1` 可以是字符串。

{{ self.title_sample_description() }}

这是第一组数据的样例说明。

{{ s('sample', 2) }}

{{ self.sample_file() }}

这组样例满足测试点 $1,2$ 的限制。

{{ s('sample', 3) }}

{{ self.sample_file() }}

这组样例满足测试点 $5\sim 7$ 的限制。

{{ s('sample', 4) }}

{{ self.sample_file() }}

这组样例满足测试点 $8,9$ 的限制。

{{ s('sample', 5) }}

{{ self.sample_file() }}

这组样例满足测试点 $10\sim 14$ 的限制。

{{ s('sample', 6) }}

{{ self.sample_file() }}

这组样例满足测试点 $15\sim 17$ 的限制。

{{ s('sample', 7) }}

{{ self.sample_file() }}

这组样例满足测试点 $18\sim 20$ 的限制。

{{ s('部分分设置') }}

对于 $100\%$ 的数据，$1\le T\le 2000$，$\sum (n+q)\le 2\times 10^6$，$1\le n,q\le 10^6$，$0\le type\le 1$，且在任何时候都保证 $1\le a_i\le 2\times 10^9$，$|w_i|\le 2\times 10^9$。

对于任意一次变化，保证 $o$ 为 $1$ 或 $2$，且 $1\le p\le n$。$o=1$ 时，保证 $1\le x\le 2\times 10^9$；$o=2$ 时，保证 $|x|\le 2\times 10^9$。

特别地，$w_i$ 中的每一项在变化的过程中一定单调不递增。

{{tbl('data')}}

特殊性质 A：对于所有测试数据，$o\ne 1$。

特殊性质 B：对于所有测试数据，$o\ne 2$。

特殊性质 C：对于所有测试数据，$type=0$。